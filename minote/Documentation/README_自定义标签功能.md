# 心情记录应用 - 自定义标签功能

## 新增功能

### 🏷️ 自定义标签系统

#### 心情标签
- 用户可以创建自定义心情标签
- 支持自定义颜色选择（12种预设颜色）
- 预设标签：开心、平静、难过、生气、焦虑、兴奋
- 默认自定义标签：感激、疲惫、满足、迷茫

#### 活动标签
- 用户可以创建自定义活动标签
- 支持自定义图标选择（16种预设SF Symbols图标）
- 预设标签：工作、学习、运动、休息、娱乐、社交、吃饭、通勤
- 默认自定义标签：冥想、购物、清洁、旅行

### 📝 如何使用自定义标签

#### 添加新记录时
1. 在"选择心情"部分，点击"+"按钮添加新的心情标签
2. 输入标签名称，选择喜欢的颜色
3. 在"选择活动"部分，点击"添加标签"按钮添加新的活动标签
4. 输入标签名称，选择合适的图标

#### 编辑现有记录时
- 同样支持创建新的自定义标签
- 可以将现有记录的标签更改为自定义标签

### 🔧 设置页面功能

#### 数据统计
- 显示总记录数和总时长
- 显示自定义心情标签和活动标签的数量

#### 数据管理
- **导出数据**：将所有记录导出为CSV文件
- **导入数据**：从CSV文件导入记录（自动识别和映射自定义标签）

#### 自定义标签管理
- 查看自定义标签统计
- **清理未使用标签**：删除没有被任何记录使用的自定义标签（保留默认标签）

### 📊 CSV 导入导出增强

#### 导出功能
- 自动包含所有自定义标签的颜色和图标信息
- 文件命名格式：`心情记录_YYYY-MM-DD.csv`

#### 导入功能
- 支持包含自定义标签的CSV文件
- 自动匹配现有的自定义标签
- 如果标签不存在，会使用默认的颜色和图标

### 💾 数据存储

#### SwiftData 模型
- `MoodRecord`：心情记录数据
- `CustomMoodTag`：自定义心情标签
- `CustomActivityTag`：自定义活动标签

#### 数据持久化
- 所有自定义标签会被保存到本地数据库
- 支持标签的创建、使用和删除
- 区分默认标签和用户创建的标签

### 🎨 界面特性

#### 标签选择界面
- 网格布局展示所有可用标签
- 清晰的视觉反馈显示当前选中的标签
- 一键添加新标签的便捷按钮

#### 颜色和图标选择
- 直观的颜色选择器（圆形色块）
- 丰富的SF Symbols图标库
- 实时预览选择效果

### 🔄 向后兼容性

- 现有的记录和数据完全兼容
- 预设的心情和活动标签继续可用
- CSV 导入导出保持向下兼容

## 技术实现

### 核心组件
- `AddMoodTagView`：添加自定义心情标签
- `AddActivityTagView`：添加自定义活动标签
- `CSVHelper`：增强的CSV处理，支持自定义标签

### 数据流
1. 用户创建自定义标签 → 保存到SwiftData
2. 记录使用自定义标签 → 关联存储
3. CSV导出 → 包含标签信息
4. CSV导入 → 自动映射和创建标签

这个功能让用户能够完全个性化他们的心情和活动记录，提供了更灵活和个性化的使用体验。
